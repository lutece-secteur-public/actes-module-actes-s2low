
#Descriptif du module S²low
![](http://dev.lutece.paris.fr/plugins/module-actes-s2low/images/logo_s2low.gif)
##Introduction

Ce module réalise, pour le [plugin ACTES](https://github.com/lutece-secteur-public/actes-plugin-actes) , la télétransmission des actes via la plate-forme S²low de l'Adullact.

Pour plus d'informations sur la plate-forme S²low, reportez-vous aux liens fournis dans le menu.

#Installation

##Pré-requis

Ce module nécessite une version 2.1.2 ou supérieure du noyau Lutece (lutece-core)

Le [plugin ACTES](/plugins/plugin-actes/fr/index.html) doit être installé.

Le module nécessite un certificat client X.509 fourni par l'Adullact pour se connecter à la plate-forme

##Fabrication et déploiement (build et deploy)

Pour construire la dernière version du module suivez les instructions suivantes :

(NB: Le client Subversion et Maven2 doivent être installés sur votre système)


```

$ svn export http://dev.lutece.paris.fr/svn/lutece/portal/trunk/plugins/module-actes-s2low module-actes-s2low
$ cd module-actes-s2low
$ mvn lutece:assembly
                        
```


La dernière commande construit un package du module sous la forme d'un zip dénommé `module-actes-s2low-xxx-bin-xxxx.zip` dans le répertoire `./target/assembly` 

Pour déployer ce package, il suffit simplment de la dézipper dans la racine de votre webapp.

##Configuration

Ce module utilise l'API HTTP de la plate-forme S²low. Le dialogue est basé le protocole sécurisé HTTPS avec une authentification mutuelle,c'est dire que le client et le serveur doivent s'authentifier l'un vis à vis de l'autre à l'aide de certificats.

Pour la mise en oeuvre du protocole HTTPS, le plugin utilise l'API [JSSE (Java Secure Socket Extension)](http://java.sun.com/javase/technologies/security/) et ses mécanismes de stockage des certificats pour être utilisés par des programmes Java (keystores, truststores).

Pour que le module S²low valide le serveur, il faut stocker dans un truststore le certificat du serveur en indiquant que l'on fait confiance à ce certificat. Celui-ci peut êtreobtenu en acceptant une connexion https au serveur S²low avec votre navigateur et en exportant ensuite ce certificat. Pour créer le truststore,il faut utiliser l'outil `keytool` fourni avec le JDK de la manière suivante :


```

keytool -import -alias s2lowserver -keystore /path/truststore.jks -file /path/s2lowserver.cer
```


Cette commande crée le truststore nommé `truststore.jks` dans le répertoire path et y importe le certificat dont le chemin est `/path/s2lowserver.cer` . Un mot de passe vous sera demandé.

Pour que le serveur valide le client, il faut créer un keystore contenant un certificat client associé à un jeu de clés publique/privé dont le serveur dispose de la clé publique. Ces élements sont fournisdans un fichier .p12 fourni par l'Adullact.

Pour créer ce keystore, la solution la plus simple est d'utiliser la classe utilitaire fournie avec le serveur Jetty comme suit :


```

java -jar jetty.jar org.mortbay.util.PKCS12Import client.p12 /path/keytore.jks 
```


Cette commande crée le keystore nommé `keystore.jks` dans le répertoire path à partir du certificat .p12 fourni par l'Adullact. Le mot de passe du keystore est celui lié au certificatet il est lui aussi fourni par l'Adullact.

Dans le fichier `WEB-INF/conf/plugins/actes-s2low.properties` configurer :


 
* le nom d'hôte et le port du serveur S²low
* les paramètres du keystore contenant le certificat client et le jeu de clés privé/publique fourni par l'Adullact : chemin, mot de passe et type
* les paramètres du truststore contenant le certificat du serveur : chemin, mot de passe et type
* les paramètres du proxy si nécessaire


Après lancement de la webapp, activer le module par l'interface "Gestion des plugins" du module d'administration


[Maven documentation and reports](http://dev.lutece.paris.fr/plugins/module-actes-s2low/)



 *generated by [xdoc2md](https://github.com/lutece-platform/tools-maven-xdoc2md-plugin) - do not edit directly.*